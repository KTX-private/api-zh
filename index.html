

<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Ktx API文档(v4)</title>
    <link rel="icon" type="image/x-icon" href="images/favicon-2c0a43f8.ico" />
    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-886ee864.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-f9e168eb.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-e033bdd3.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <header>
      <div class="flex_box">
        <img src="images/logo-86553777.png" class="logo" id="ex-logo" alt="" />
        <div class="nav_box">
        </div>
      </div>
      <a href="/api-en/" class="lang" id="lang_box">English</a>
    </header>
    <div class="toc-wrapper">
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#b122f813d5" class="toc-h1 toc-link" data-title="基本信息">基本信息</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#api" class="toc-h2 toc-link" data-title="API">API</a>
                  </li>
                  <li>
                    <a href="#a4d31b2542" class="toc-h2 toc-link" data-title="流量限制">流量限制</a>
                  </li>
                  <li>
                    <a href="#32c808cbe5" class="toc-h2 toc-link" data-title="认证">认证</a>
                  </li>
                  <li>
                    <a href="#api-key" class="toc-h2 toc-link" data-title="Api Key权限">Api Key权限</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#market-data-endpoints" class="toc-h1 toc-link" data-title="Market Data Endpoints">Market Data Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#effb22c7a1" class="toc-h2 toc-link" data-title="测试连通性">测试连通性</a>
                  </li>
                  <li>
                    <a href="#3f1907847c" class="toc-h2 toc-link" data-title="获取服务器时间">获取服务器时间</a>
                  </li>
                  <li>
                    <a href="#403bc6eb40" class="toc-h2 toc-link" data-title="获取币种信息">获取币种信息</a>
                  </li>
                  <li>
                    <a href="#f43215ae26" class="toc-h2 toc-link" data-title="获取交易对">获取交易对</a>
                  </li>
                  <li>
                    <a href="#3c891debc8" class="toc-h2 toc-link" data-title="获取订单薄">获取订单薄</a>
                  </li>
                  <li>
                    <a href="#k" class="toc-h2 toc-link" data-title="获取K线">获取K线</a>
                  </li>
                  <li>
                    <a href="#16d070eefb" class="toc-h2 toc-link" data-title="获取成交记录">获取成交记录</a>
                  </li>
                  <li>
                    <a href="#tickers" class="toc-h2 toc-link" data-title="获取 Tickers">获取 Tickers</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#market-data" class="toc-h1 toc-link" data-title="Market Data 推送">Market Data 推送</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#af7bfdc5fa" class="toc-h2 toc-link" data-title="请求类型及参数">请求类型及参数</a>
                  </li>
                  <li>
                    <a href="#b036e4f7db" class="toc-h2 toc-link" data-title="订阅深度信息">订阅深度信息</a>
                  </li>
                  <li>
                    <a href="#c9c3db0959" class="toc-h2 toc-link" data-title="订阅交易列表">订阅交易列表</a>
                  </li>
                  <li>
                    <a href="#k-2" class="toc-h2 toc-link" data-title="订阅K线">订阅K线</a>
                  </li>
                  <li>
                    <a href="#ticker" class="toc-h2 toc-link" data-title="订阅ticker">订阅ticker</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#user-data-endpoints" class="toc-h1 toc-link" data-title="User Data Endpoints">User Data Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#85dc7f40ef" class="toc-h2 toc-link" data-title="获取交易账户资产">获取交易账户资产</a>
                  </li>
                  <li>
                    <a href="#b3114995fd" class="toc-h2 toc-link" data-title="获取充值地址">获取充值地址</a>
                  </li>
                  <li>
                    <a href="#a471daf080" class="toc-h2 toc-link" data-title="提现">提现</a>
                  </li>
                  <li>
                    <a href="#861428a8b4" class="toc-h2 toc-link" data-title="获取钱包账户资产">获取钱包账户资产</a>
                  </li>
                  <li>
                    <a href="#0d3c2e7382" class="toc-h2 toc-link" data-title="资产划转">资产划转</a>
                  </li>
                  <li>
                    <a href="#12c1ebfd1f" class="toc-h2 toc-link" data-title="子账户资产划转">子账户资产划转</a>
                  </li>
                  <li>
                    <a href="#c3362c0aff" class="toc-h2 toc-link" data-title="获取账单">获取账单</a>
                  </li>
                  <li>
                    <a href="#5ac84906d9" class="toc-h2 toc-link" data-title="创建订单">创建订单</a>
                  </li>
                  <li>
                    <a href="#f876a4e1f9" class="toc-h2 toc-link" data-title="获取订单详情">获取订单详情</a>
                  </li>
                  <li>
                    <a href="#e8c2c8c42b" class="toc-h2 toc-link" data-title="获取历史订单列表">获取历史订单列表</a>
                  </li>
                  <li>
                    <a href="#ef41056898" class="toc-h2 toc-link" data-title="获取未成交订单列表">获取未成交订单列表</a>
                  </li>
                  <li>
                    <a href="#3eedd32d80" class="toc-h2 toc-link" data-title="取消订单">取消订单</a>
                  </li>
                  <li>
                    <a href="#eaa1a6d463" class="toc-h2 toc-link" data-title="取消批量订单">取消批量订单</a>
                  </li>
                  <li>
                    <a href="#430d71f05a" class="toc-h2 toc-link" data-title="获取仓位">获取仓位</a>
                  </li>
                  <li>
                    <a href="#106a02279b" class="toc-h2 toc-link" data-title="获取成交明细">获取成交明细</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#user-data" class="toc-h1 toc-link" data-title="User Data 推送">User Data 推送</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview-2" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#account" class="toc-h2 toc-link" data-title="Account">Account</a>
                  </li>
                  <li>
                    <a href="#position" class="toc-h2 toc-link" data-title="Position">Position</a>
                  </li>
                  <li>
                    <a href="#order" class="toc-h2 toc-link" data-title="Order">Order</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#e08c1d4f9a" class="toc-h2 toc-link" data-title="错误码">错误码</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://www.ktx.com'>开始交易</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='b122f813d5'>基本信息</h1><h2 id='api'>API</h2>
<p><strong>使用API开发应用程序,您可以准确地获取Ktx现货市场的行情数据,快速进行自动化交易。API包含众多接口,按功能大致分为以下几组：</strong></p>

<ul>
<li>Market Data Endpoints 用于获取行情数据的REST接口</li>
<li>User Data Endpoints 用于获取用户私有数据的REST接口</li>
<li>Market Data Streams 用于获取行情数据的WebSocket接口</li>
<li>User Data Streams 用于获取用户私有数据的WebSocket接口</li>
</ul>

<p><strong>API使用如下Base URL：</strong></p>

<ul>
<li>Market Data Endpoints: https://api.ktx.com/api</li>
<li>User Data Endpoints: https://api.ktx.com/papi (老版本的路径是以/api结尾的,现在已经不支持了,请务必使用/papi)</li>
<li>Market Data Stream: wss://m-stream.ktx.com</li>
<li>User Data Stream: wss://u-stream.ktx.com</li>
</ul>

<p><strong>备用api域名列表</strong></p>

<p><a href="https://api.ktx.com/api/v1/pu/domains">https://api.ktx.com/api/v1/pu/domains</a></p>

<p><strong>API的REST接口使用以下HTTP方法：</strong></p>

<ul>
<li>GET 用于获取行情或私有数据</li>
<li>POST 用于提交委托等操作</li>
</ul>

<p><strong>API的REST接口所需的参数应根据以下规则附加于请求中：</strong></p>

<ul>
<li>GET类型的接口参数应附加于Query String中</li>
<li>POST类型的接口参数应以JSON格式附加于Request Body中</li>
</ul>

<p><strong>Response</strong></p>

<p>API的响应数据都以JSON格式返回,具体格式请参考各接口的描述。</p>

<p><strong>Error</strong></p>

<p>API的错误以如下JSON格式返回：</p>

<p>{<br/>
&nbsp;&nbsp;&quot;state&quot;: error code,<br/>
&nbsp;&nbsp;&quot;msg&quot;: &quot;error message&quot;<br/>
}</p>

<p><em>其中,state表示错误的类型,msg包含错误产生的原因或如何避免错误的提示。具体的错误类型请参考<a href="#errors">Error</a>章节的内容。</em></p>

<p><strong>Time or Timestamp</strong></p>

<p>API接口参数和响应数据中所涉及的时间值都是UNIX时间,单位为毫秒。</p>

<hr>
<h2 id='a4d31b2542'>流量限制</h2>
<p><strong>Ktx对来自于同一IP的请求做以下访问限制:</strong></p>

<ol>
<li>Access Limits 访问频率限制</li>
<li>Usage Limits CPU用量限制</li>
</ol>

<ul>
<li>Access Limits访问频率限制

<ol>
<li>同一IP每10秒最多10000次请求,超出限制的请求会收到-20007错误。</li>
<li>用户可以根据需要在10秒内以任意频率发送最多10000次请求,可以大约每10ms发送一次,也可以在1秒内连续发送10000次,然后等待9秒。
<br/>
<br/></li>
</ol></li>
<li>Usage Limits用量限制

<ol>
<li>同一IP每10秒最多消耗10000点CPU 时间,超出限制的请求会收到-20006错误。</li>
<li>不同API消耗的CPU时间不同,这取决于API如何访问数据。</li>
<li>在本文中, 每个API接口访问数据的方式会以“缓存”, “数据库”的形式标明。访问缓存的API消耗的CPU时间较少,访问数据库的API消耗的CPU时间较多。根据用户发送的参数,API可能混合访问缓存和数据库,甚至多次访问数据库,这会增加API消耗的CPU时间。</li>
<li>每次API请求消耗的CPU时间会包含在响应头Ktx-Usage中,其格式为t1:t2:t3,其中,t1表示本次API请求消耗的CPU时间,t2表示最近10秒内当前IP消耗的CPU时间,t3表示最近10秒内当前IP剩余的可用CPU时间。</li>
</ol></li>
</ul>

<hr>
<h2 id='32c808cbe5'>认证</h2>
<blockquote>
<p>完整例子</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">asset=BTC</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span> <span class="c1">// POST or DELETE  replace queryStr with bodyStr</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/trade/accounts?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
          <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span>
          <span class="p">},</span>
        <span class="p">},</span>

        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/trade/accounts'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'asset=BTC'</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="c1"># POST or DELETE replace query_str with body_str
</span>    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">query_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span> <span class="n">expire_time</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<p><strong>身份验证</strong></p>

<ul>
<li>私有接口用于访问账户、委托等私有信息,在请求时需要附加签名,以满足Ktx进行身份验证。本节将描述如何创建签名。</li>
</ul>

<p><strong>生成Api Key</strong></p>

<ul>
<li>要创建签名,首先需要生成Api Key和Secret Key组合。请牢记在此过程中生成的Secret Key,因为该值仅显示一次,如果忘记了Secret Key,请删除该Api Key,并生成新的Api Key和Secret Key组合。</li>
</ul>

<p><strong>HTTP 请求头</strong></p>

<p><strong>访问私有接口的请求都必需附加以下HTTP请求头：</strong></p>

<ul>
<li>api-key 已生成的Api Key</li>
<li>api-sign 签名</li>
</ul>

<p><strong>如果需要,也可以附加以下HTTP请求头：</strong></p>

<ul>
<li>api-expire-time

<ol>
<li>接口过期时间。</li>
<li>该值是以毫秒为单位的Unix时间,服务器会忽略该时间之后收到的请求,这主要用于避免网络延迟带来的影响。</li>
</ol></li>
</ul>

<p><strong>创建签名</strong></p>

<p>在发送请求前,首先确定用于签名的消息体。对于GET类型的请求,Query String是需要签名的消息体,对于POST请求,Body String是需要签名的消息体,expire_time 是过期时间
签名的具体方法如下：</p>

<ul>
<li>第一步：获取当前时间戳 + 有效时间
使用 Date.now() 获取当前毫秒时间戳,并加上一个短暂的有效期（如 5000 毫秒）,表示请求将在 5 秒内失效。</li>
<li>第二步：计算签名
将 [时间戳 + 请求体字符串] 作为原始数据,使用 HMAC-SHA256 算法,并使用用户的 secret 作为密钥进行加密：</li>
<li>第三步：将以上结果转化为Hex String</li>
<li>第四步：将Hex String作为请求头api-sign的值,将expire_time作为请求头api-expire-time的值</li>
</ul>
<h2 id='api-key'>Api Key权限</h2>
<p><strong>私有接口需要特定的权限才能执行。可以为Api Key授予适当的权限。如果Api Key未被授予某个接口需要的权限,那么使用该Api Key提交的请求将被拒绝。</strong></p>

<p><strong>可以授予Api Key以下权限：</strong></p>

<ul>
<li>View权限允许Api Key获取私有数据。</li>
<li>Trade权限允许Api Key提交或撤销委托,并允许Api Key获取交易相关的数据。</li>
</ul>

<p><em>接口需要的权限将在每个接口的描述中给出。</em></p>

<hr>
<h1 id='market-data-endpoints'>Market Data Endpoints</h1><h2 id='effb22c7a1'>测试连通性</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/ping`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/ping'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre></div><h2 id='3f1907847c'>获取服务器时间</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/time`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/time'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/ping'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="nl">"time"</span><span class="p">:</span><span class="s2">"1746777864508"</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='403bc6eb40'>获取币种信息</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/coins`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/coins'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产名称</span><span class="w">
    </span><span class="nl">"valid_decimals"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产精度</span><span class="w">
    </span><span class="nl">"enable_transfer"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">允许划转</span><span class="w">
    </span><span class="nl">"chains"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">币种名称</span><span class="w">
        </span><span class="nl">"chain_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tron (TRC20)"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">网络</span><span class="w">
        </span><span class="nl">"enable_withdraw"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">允许提现</span><span class="w">
        </span><span class="nl">"enable_deposit"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">允许充值</span><span class="w">
        </span><span class="nl">"original_decimals"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">网络精度</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eUSDT"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"chain_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ethereum (ERC20)"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"enable_withdraw"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"enable_deposit"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"original_decimals"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bUSDT"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"chain_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BNB Smart Chain (BEP20)"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"enable_withdraw"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"enable_deposit"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"original_decimals"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sUSDT"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"chain_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Solana"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"enable_withdraw"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"enable_deposit"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"original_decimals"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w"> 
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取币种信息</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/coins</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
</tbody></table>
<h2 id='f43215ae26'>获取交易对</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/products?market=spot&amp;symbol=BTC_USDT`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/products?market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"market"</span><span class="p">:</span><span class="w"> </span><span class="s2">"lpc"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">spot</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">lpc</span><span class="w"> </span><span class="err">现货或者合约</span><span class="w">
    </span><span class="nl">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对</span><span class="w">
    </span><span class="nl">"takerFee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.001"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">taker手续费</span><span class="w">
    </span><span class="nl">"makerFee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.001"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">手续费</span><span class="w">
    </span><span class="nl">"minOrderSize"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0001"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最小下单数量</span><span class="w">
    </span><span class="nl">"maxOrderSize"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">最大下单数量</span><span class="w">
    </span><span class="nl">"quantityScale"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">数量精度</span><span class="w">
    </span><span class="nl">"priceScale"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">价格精度</span><span class="w">
    </span><span class="nl">"minOrderValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0001"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最小下单价值</span><span class="w">
    </span><span class="nl">"maxOrderValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10000000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最大下单价值</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取交易对列表</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/products</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>否</td>
<td>交易对市场,如 spot(默认), lpc 等,spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>否</td>
<td>交易对代码,如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等,不指定返回全部交易对</td>
</tr>
</tbody></table>

<ul>
<li>Data source</li>
</ul>

<p>Cache</p>
<h2 id='3c891debc8'>获取订单薄</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/order_book?market=spot&amp;symbol=BTC_USDT`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/order_book?market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="mi">1027024</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
  </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1644558642100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="w">
  </span><span class="nl">"b"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">买盘</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"a"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖盘</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>获取深度数据</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/order_book</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>否</td>
<td>交易对市场,如 spot(默认), lpc 等,spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码,如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等</td>
</tr>
<tr>
<td>level</td>
<td>int32</td>
<td>否</td>
<td>指定最多返回多少级深度<br/>有效值 1, 2, 5, 10, 20, 50, 100, 200, 500, 1000<br/>默认值 100</td>
</tr>
<tr>
<td>price_scale</td>
<td>integer</td>
<td>否</td>
<td>指定按价格合并深度,如指定交易对的价格最多含4位小数<br/>price_scale=0 时返回的价格最多含4位小数,<br/>price_scale=1 时返回的价格最多含3位小数, 委托量是价格区间0.0010中全部委托量的和<br/>price_scale=2 时返回的价格最多含2位小数, 委托量是价格区间0.0100中全部委托量的和<br/>price_scale=3 时返回的价格最多含1位小数, 委托量是价格区间0.1000中全部委托量的和<br/>price_scale=4 时返回的价格最多含0位小数, 委托量是价格区间1.0000中全部委托量的和<br/>有效值 0, 1, 2, 3, 4, 5<br/>默认值 0</td>
</tr>
</tbody></table>

<blockquote>
<p>注意: 数据按价格最优排序, 即买侧深度按价格由大到小排序, 卖侧深度按价格由小到大排序</p>
</blockquote>

<ul>
<li>Data source</li>
</ul>

<p>Cache</p>
<h2 id='k'>获取K线</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/candles?market=spot&amp;symbol=BTC_USDT&amp;time_frame=1m`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/candles?market=spot&amp;symbol=BTC_USDT&amp;time_frame=1m'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="mi">60000</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">时间周期</span><span class="w">
  </span><span class="nl">"e"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"1644224940000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">起始时间</span><span class="w">
      </span><span class="s2">"10190.53"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开盘价格</span><span class="w">
      </span><span class="s2">"10192.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最高价格</span><span class="w">
      </span><span class="s2">"9806.82"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最低价格</span><span class="w">
      </span><span class="s2">"10127.37"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">收盘价格</span><span class="w">
      </span><span class="s2">"0.834"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
      </span><span class="s2">"8370.40506"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价值</span><span class="w">
      </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">首个成交的id</span><span class="w">
      </span><span class="mi">278</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">区间内总成交次数</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"1644224940000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"10190.53"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"10192.5"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"9806.82"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"10127.37"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"0.834"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"8370.40506"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
      </span><span class="mi">278</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>获取K线数据</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/candles</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>否</td>
<td>交易对市场,如 spot(默认), lpc 等,spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码,如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等</td>
</tr>
<tr>
<td>time_frame</td>
<td>string</td>
<td>是</td>
<td>K线数据的时间周期<br/>有效值 1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 1W或1M</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>utc时间<br/>限定返回K线记录的最近时间</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>utc时间<br/>限定返回K线记录的最早时间</td>
</tr>
<tr>
<td>limit</td>
<td>integer</td>
<td>否</td>
<td>获取K线记录的最大数量<br/>默认值100,最大值1000</td>
</tr>
</tbody></table>

<ul>
<li>该接口支持的参数组合和数据源</li>
</ul>

<ol>
<li>market + symbol + time_frame  --&gt; cache</li>
<li>market + symbol + time_frame + limit  --&gt; cache</li>
<li>market + symbol + time_frame + before  --&gt; database</li>
<li>market + symbol + time_frame + before + limit  --&gt; database</li>
<li>market + symbol + time_frame + after  --&gt; database</li>
<li>market + symbol + time_frame + after + limit  --&gt; database</li>
</ol>

<blockquote>
<p>返回结果按时间由早及近排序</p>
</blockquote>
<h2 id='16d070eefb'>获取成交记录</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/trades?market=spot&amp;symbol=BTC_USDT`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/trades?market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="mi">17122255</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
    </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.079045"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
    </span><span class="nl">"s"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Taker</span><span class="w"> </span><span class="err">的成交方向</span><span class="w"> </span><span class="mi">1</span><span class="err">代表买</span><span class="w"> </span><span class="mi">-1</span><span class="err">代表卖</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1628738748319"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="mi">17122255</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
    </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.079045"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
    </span><span class="nl">"s"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Taker</span><span class="w"> </span><span class="err">的成交方向</span><span class="w"> </span><span class="mi">1</span><span class="err">代表买</span><span class="w"> </span><span class="mi">-1</span><span class="err">代表卖</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1628738748319"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="mi">17122255</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
    </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.079045"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
    </span><span class="nl">"s"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Taker</span><span class="w"> </span><span class="err">的成交方向</span><span class="w"> </span><span class="mi">1</span><span class="err">代表买</span><span class="w"> </span><span class="mi">-1</span><span class="err">代表卖</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1628738748319"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取交易记录</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/trades</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>否</td>
<td>交易对市场,如 spot(默认), lpc 等,spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码,如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回交易记录的最早时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回交易记录的最近时间</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>交易记录 id<br/>限定返回交易记录的最大id</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>交易记录 id<br/>限定返回交易记录的最大id</td>
</tr>
<tr>
<td>limit</td>
<td>integer</td>
<td>否</td>
<td>获取记录的最大数量<br/>默认值100,最大值1000</td>
</tr>
</tbody></table>

<ul>
<li>该接口支持的参数组合和数据源</li>
</ul>

<ol>
<li>market + symbol  --&gt; cache</li>
<li>market + symbol + limit  --&gt; cache</li>
<li>market + symbol + start_time  --&gt; database</li>
<li>market + symbol + start_time + limit  --&gt; database</li>
<li>market + symbol + end_time  --&gt; database</li>
<li>market + symbol + end_time + limit  --&gt; database</li>
<li>market + market + symbol + start_time + end_time  --&gt; database</li>
<li>market + symbol + start_time + end_time + limit  --&gt; database</li>
<li>market + symbol + before  --&gt; database</li>
<li>market + symbol + before + limit  --&gt; database</li>
<li>market + symbol + after  --&gt; database</li>
<li>market + symbol + after + limit  --&gt; database</li>
</ol>

<p><em>数据源为cache的参数组合用于获取最近1000条交易记录</em></p>

<p><em>数据源为database的参数组合用于获取较早的交易记录</em></p>

<p><em>如果用数据源为database的参数组合获取最新交易记录,其结果要比cache数据源稍有延迟</em>
* Usage
  <strong>用法举例：获取三个月内某交易对的全部交易记录</strong></p>

<ol>
<li>首先使用symbol + limit 参数组合获取最新的交易记录</li>
<li>将取到的首条记录的tradeId作为before参数的值,反复使用symbol + before + limit参数组合获取更多记录,直至获取三个月内的全部交易记录后停止</li>
</ol>

<blockquote>
<p>返回结果按交易记录id由小到大排序</p>
</blockquote>
<h2 id='tickers'>获取 Tickers</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/ticker?market=spot&amp;symbol=BTC_USDT`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/ticker?market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"askPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖一价</span><span class="w">
    </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"922635"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">成交价值</span><span class="w">
    </span><span class="nl">"last"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最新成交价</span><span class="w">
    </span><span class="nl">"firstTradeId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">第一笔交易id</span><span class="w">
    </span><span class="nl">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">价格变化</span><span class="w">
    </span><span class="nl">"bidQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖一数量</span><span class="w">
    </span><span class="nl">"bidPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">买一价</span><span class="w">
    </span><span class="nl">"volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.41"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">h成交数量</span><span class="w">
    </span><span class="nl">"lastQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.3"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">h最新成交</span><span class="w">
    </span><span class="nl">"askQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖一数量</span><span class="w">
    </span><span class="nl">"high"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">最高价</span><span class="w">
    </span><span class="nl">"tradeCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
    </span><span class="nl">"low"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">h最低价</span><span class="w">
    </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733474204000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">时间</span><span class="w">
    </span><span class="nl">"open"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开盘价格</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取ticker</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/ticker</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>否</td>
<td>交易对市场,如 spot(默认), lpc 等,spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码,如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等,<br/>可按如下两种形式指定多个交易对代码<br/> 1. symbol=BTC_USDT,ETH_USDT</td>
</tr>
</tbody></table>

<ul>
<li>Data Source</li>
</ul>

<p>Cache</p>
<h1 id='market-data'>Market Data 推送</h1><h2 id='overview'>Overview</h2>
<blockquote>
<p>例子</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">ktxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://m-stream.ktx.com</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ktxws</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">ktxws</span><span class="p">);</span>
    <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">SUBSCRIBE</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">params</span><span class="dl">"</span><span class="p">:[</span><span class="dl">"</span><span class="s2">spot.BTC_USDT.order_book.5</span><span class="dl">"</span><span class="p">]}));</span>
        <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="nx">ws</span><span class="p">.</span><span class="nx">ping</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
        <span class="p">},</span><span class="mi">30000</span><span class="p">)</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">rece message</span><span class="dl">"</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">websocket</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://m-stream.ktx.com'</span>

<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="s">"</span><span class="se">\"</span><span class="s">"</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_sub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span><span class="s">"method"</span><span class="p">:</span><span class="s">"SUBSCRIBE"</span><span class="p">,</span><span class="s">"params"</span><span class="p">:[</span><span class="s">"spot.BTC_USDT.order_book.5"</span><span class="p">]}</span> 
    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">close_status_code</span><span class="p">,</span> <span class="n">close_msg</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Status Code:"</span><span class="p">,</span> <span class="n">close_status_code</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Message:"</span><span class="p">,</span> <span class="n">close_msg</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ping_loop</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
  <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">"ping"</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="p">}</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">get_sub_str</span><span class="p">())</span>
    <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">ping_loop</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">ws</span><span class="p">,),</span> <span class="n">daemon</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">start</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="c1"># websocket.enableTrace(True)
</span>    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div>
<p><strong>使用 Websocket 推送服务可以及时获取行情信息。</strong></p>

<ul>
<li>连接 Websocket 服务器
请使用以下 URL 连接 Websocket 服务器：
<br/>
wss://m-stream.ktx.com</li>
</ul>

<blockquote>
<p>在连接后,客户端可以发送以下JSON格式的请求给服务器</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">由客户端给定的请求id</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">请求类型</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:[</span><span class="s2">"spot.BTC_USDT.order_book.5"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>在收到请求后,服务器会发送以下JSON格式的响应给客户端</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">返回结果</span><span class="w">
  </span><span class="nl">"op"</span><span class="p">:</span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">由客户端给定的请求id</span><span class="w">
  </span><span class="nl">"events"</span><span class="p">:[</span><span class="s2">"spot.BTC_USDT.order_book.5"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>如果发生错误,服务器会发送以下错误信息给客户端</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">请求id</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="mi">-1003</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">错误代码</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">错误描述</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>同时,服务器还会发送以下JSON格式的数据流给客户端, 数据流包含市场行情的变化信息</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spot.BTC_USDT.order_book.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">数据流名称</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">数据</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>请求：订阅数据流</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"stream name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"stream name"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>在连接后,请首先发送该请求给服务器,随后,服务器会在行情变化时发送相应的数据流给客户端。</p>

<p>&quot;data stream name&quot; 是数据流名称,数据流名称是以下格式的字符串。
market.symbol.data_type.param1.param2...</p>

<p>其中,market是交易对市场,如spot和lpc
symbol是交易对名称,如 BTC_USDT、ETH_USDT 等。
data_type是数据类型,目前仅支持以下数据类型
order_book: 深度
trades: 交易列表
candles: K线
ticker: 最新成交信息</p>

<p>在data_type之后是参数列表,不同的数据类型有不同的参数列表,这些将在后续介绍</p>

<p>请求: 取消订阅数据流</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNSUBSCRIBE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"data stream name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data stream name"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>如果请求被服务器正确处理,客户端会收到以下响应:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">返回结果</span><span class="w">
    </span><span class="nl">"op"</span><span class="p">:</span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w"> 
    </span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>如果请求出错,客户端会收到以下错误响应:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="mi">-1003</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">错误代码</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">错误描述</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='af7bfdc5fa'>请求类型及参数</h2>
<blockquote>
<p>请求类型及参数</p>

<p>客户端可以发送以下请求给服务器</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">由客户端给定的请求id</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">请求类型</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">请求参数列表</span><span class="w">
    </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>其中method字段的值是以下请求类型之一:</li>
</ul>

<table><thead>
<tr>
<th>可选值</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SUBSCRIBE</td>
<td>1.订阅数据流<br/> 2.参数是数据流名称列表 <br/> 3.在成功订阅后,服务器会在行情发生变化时发送数据流给客户端</td>
</tr>
<tr>
<td>UNSUBSCRIBE</td>
<td>1.取消订阅数据流<br/> 2.参数是数据流名称列表 <br/> 3.在成功取消订阅后,客户端不会再收到相应的数据流</td>
</tr>
</tbody></table>
<h2 id='b036e4f7db'>订阅深度信息</h2>
<p><strong>订阅深度信息</strong></p>

<blockquote>
<p>发送以下请求可订阅深度信息</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"spot.BTC_USDT.order_book.20"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"spot.ETH_USDT.order_book.20"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>参数</li>
</ul>

<ol>
<li>该请求的参数是深度流名称,格式如下：</li>
</ol>

<ul>
<li>&lt;market&gt;&lt;symbol&gt;.order_book.&lt;max_depth&gt;

<ol>
<li>&lt;market&gt; 是交易对市场,如spot,lpc</li>
<li>&lt;symbol&gt; 是交易对名称,如BTC_USDT,ETH_USDT等</li>
<li>&lt;max_depth&gt; 是最大深度,有效值是5, 10, 20, 50, 100, 200, 500, 1000</li>
</ol></li>
</ul>

<blockquote>
<p>数据流</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spot.BTC_USDT.order_book.20"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="mi">1027024</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
      </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1644558642100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="w">
      </span><span class="nl">"b"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">买盘</span><span class="w">
        </span><span class="p">[</span><span class="w">
            </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
            </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
          </span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="w">
            </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
            </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
          </span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="w">
            </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
            </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
          </span><span class="p">],</span><span class="w">
        </span><span class="err">...</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"a"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖盘</span><span class="w">
        </span><span class="p">[</span><span class="w">
            </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
            </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
          </span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="w">
            </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
            </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
          </span><span class="p">],</span><span class="w">
        </span><span class="p">[</span><span class="w">
            </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
            </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
          </span><span class="p">],</span><span class="w">
       </span><span class="err">...</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>在成功订阅后,客户端会首先收到一个完整深度的数据流,之后会收到增量变化数据流,请按以下方法合成完整的深度,或使用SDK.</p>
</blockquote>
<h2 id='c9c3db0959'>订阅交易列表</h2>
<p><strong>订阅交易列表</strong></p>

<blockquote>
<p>发送以下请求可订阅交易列表</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"spot.BTC_USDT.trades"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"spot.ETH_USDT.trades"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>参数</li>
</ul>

<ol>
<li>该请求的参数是交易流名称,格式如下：</li>
</ol>

<ul>
<li>&lt;market&gt;&lt;symbol&gt;.trades

<ol>
<li>&lt;market&gt; 是交易对市场,如spot,lpc</li>
<li>&lt;symbol&gt; 是交易对名称,如BTC_USDT,ETH_USDT等</li>
</ol></li>
</ul>

<blockquote>
<p>数据流</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spot.BTC_USDT.trades"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="mi">17122255</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易</span><span class="w"> </span><span class="err">id</span><span class="w">
      </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
      </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.079045"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
      </span><span class="nl">"s"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Taker</span><span class="w"> </span><span class="err">的成交方向</span><span class="w"> </span><span class="mi">1</span><span class="err">买</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="err">卖</span><span class="w">
      </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1628738748319"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="mi">17122255</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易</span><span class="w"> </span><span class="err">id</span><span class="w">
      </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
      </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.079045"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
      </span><span class="nl">"s"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Taker</span><span class="w"> </span><span class="err">的成交方向</span><span class="w">
      </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1628738748319"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="mi">17122255</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易</span><span class="w"> </span><span class="err">id</span><span class="w">
      </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
      </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.079045"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
      </span><span class="nl">"s"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Taker</span><span class="w"> </span><span class="err">的成交方向</span><span class="w">
      </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1628738748319"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='k-2'>订阅K线</h2>
<p><strong>订阅K线</strong></p>

<blockquote>
<p>发送以下请求可订阅K线</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"spot.BTC_USDT.candles.1m"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"spot.ETH_USDT.candles.1h"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>参数</li>
</ul>

<ol>
<li>K线流名称格式如下：</li>
</ol>

<ul>
<li>&lt;market&gt;&lt;symbol&gt;.candles.&lt;time_frame&gt;

<ol>
<li>&lt;market&gt; 是交易对市场,如spot,lpc</li>
<li>&lt;symbol&gt; 是交易对名称,如BTC_USDT,ETH_USDT等</li>
<li>&lt;time_frame&gt; 是K线周期,有效值是1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 1w, 1M
&gt; 数据流</li>
</ol></li>
</ul>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spot.BTC_USDT.candles.1m"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">60000</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">时间周期</span><span class="w">
      </span><span class="nl">"e"</span><span class="p">:[</span><span class="w">
      </span><span class="p">[</span><span class="w">
        </span><span class="s2">"1644224940000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">起始时间</span><span class="w">
        </span><span class="s2">"10190.53"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开盘价格</span><span class="w">
        </span><span class="s2">"10192.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最高价格</span><span class="w">
        </span><span class="s2">"9806.82"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最低价格</span><span class="w">
        </span><span class="s2">"10127.37"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">收盘价格</span><span class="w">
        </span><span class="s2">"0.834"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
        </span><span class="s2">"8370.40506"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价值</span><span class="w">
        </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">首个成交的id</span><span class="w">
        </span><span class="mi">278</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">区间内总成交次数</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="w">
        </span><span class="s2">"1644224940000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">起始时间</span><span class="w">
        </span><span class="s2">"10190.53"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开盘价格</span><span class="w">
        </span><span class="s2">"10192.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最高价格</span><span class="w">
        </span><span class="s2">"9806.82"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最低价格</span><span class="w">
        </span><span class="s2">"10127.37"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">收盘价格</span><span class="w">
        </span><span class="s2">"0.834"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
        </span><span class="s2">"8370.40506"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价值</span><span class="w">
        </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">首个成交的id</span><span class="w">
        </span><span class="mi">278</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">区间内总成交次数</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="p">[</span><span class="w">
        </span><span class="s2">"1644224940000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">起始时间</span><span class="w">
        </span><span class="s2">"10190.53"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开盘价格</span><span class="w">
        </span><span class="s2">"10192.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最高价格</span><span class="w">
        </span><span class="s2">"9806.82"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最低价格</span><span class="w">
        </span><span class="s2">"10127.37"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">收盘价格</span><span class="w">
        </span><span class="s2">"0.834"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
        </span><span class="s2">"8370.40506"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价值</span><span class="w">
        </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">首个成交的id</span><span class="w">
        </span><span class="mi">278</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">区间内总成交次数</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="err">...</span><span class="w">
    </span><span class="p">]}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='ticker'>订阅ticker</h2>
<p><strong>订阅ticker</strong></p>

<blockquote>
<p>发送以下请求可订阅Ticker</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"spot.BTC_USDT.ticker"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"spot.ETH_USDT.ticker"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>参数</li>
</ul>

<ol>
<li>Ticker流名称格式如下：</li>
</ol>

<ul>
<li>&lt;market&gt;&lt;symbol&gt;.ticker

<ol>
<li>&lt;market&gt; 是交易对市场,如spot,lpc</li>
<li>&lt;symbol&gt; 是交易对名称,如BTC_USDT,ETH_USDT等
&gt; 数据流</li>
</ol></li>
</ul>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spot.BTC_USDT.ticker"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">   
    </span><span class="nl">"askPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖一价</span><span class="w">
    </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"922635"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">成交价值</span><span class="w">
    </span><span class="nl">"last"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最新成交价</span><span class="w">
    </span><span class="nl">"firstTradeId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">第一笔交易id</span><span class="w">
    </span><span class="nl">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">价格变化</span><span class="w">
    </span><span class="nl">"bidQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖一数量</span><span class="w">
    </span><span class="nl">"bidPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">买一价</span><span class="w">
    </span><span class="nl">"volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.41"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">h成交数量</span><span class="w">
    </span><span class="nl">"lastQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.3"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">h最新成交</span><span class="w">
    </span><span class="nl">"askQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖一数量</span><span class="w">
    </span><span class="nl">"high"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">最高价</span><span class="w">
    </span><span class="nl">"tradeCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
    </span><span class="nl">"low"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">h最低价</span><span class="w">
    </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733474204000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">时间</span><span class="w">
    </span><span class="nl">"open"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开盘价格</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<hr>
<h1 id='user-data-endpoints'>User Data Endpoints</h1><h2 id='85dc7f40ef'>获取交易账户资产</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">asset=BTC</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/trade/accounts?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
          <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">exprieTime</span>
          <span class="p">},</span>
        <span class="p">},</span>

        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/trade/accounts'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'asset=BTC'</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">query_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span> <span class="n">expire_time</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">总额</span><span class="w">
    </span><span class="nl">"locked"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">冻结额</span><span class="w">
    </span><span class="nl">"free"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">可用</span><span class="w">
    </span><span class="nl">"withdrawable"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">可转出额</span><span class="w">
    </span><span class="nl">"collateral"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">是否抵扣</span><span class="w">
    </span><span class="nl">"discountForMargin"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">可选字段</span><span class="w"> </span><span class="err">保证金抵扣率</span><span class="w">
    </span><span class="nl">"discountForFee"</span><span class="p">:</span><span class="s2">"1"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">可选字段</span><span class="w"> </span><span class="err">手续费抵扣率</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="s2">"BTC"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">总额</span><span class="w">
    </span><span class="nl">"locked"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">冻结额</span><span class="w">
    </span><span class="nl">"free"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">可用</span><span class="w">
    </span><span class="nl">"withdrawable"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">可转出额</span><span class="w">
    </span><span class="nl">"collateral"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">是否抵扣</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取 API Key 对应账户中各种资产的余额, 冻结等信息</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/trade/accounts</li>
<li>权限: View</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>asset</td>
<td>string</td>
<td>否</td>
<td>资产代码,如 BTC, ETH 等<br/>可按以下两种形式指定多个资产代码<br/>1. accounts?asset=BTC,ETH<br/> 2. accounts?asset=BTC&amp;asset=ETH <br/> 如果不指定 asset 参数, 则返回全部资产的信息</td>
</tr>
</tbody></table>

<ul>
<li>Data Source</li>
</ul>

<p>Cache</p>
<h2 id='b3114995fd'>获取充值地址</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">coin_symbol</span><span class="p">:</span><span class="dl">'</span><span class="s1">sUSDT</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/depositAddr`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span> 
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'coin_symbol'</span><span class="p">:</span> <span class="s">'sUSDT'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">body_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/depositAddr'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"74VZm4a6eGGBW3VCq6umcPL8QPhs5fFnpcT9nyQGgHkw"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">地址</span><span class="w">
    </span><span class="nl">"coin_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">币种id</span><span class="w">
    </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sUSDT"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">币种</span><span class="w">
    </span><span class="nl">"chain_type"</span><span class="p">:</span><span class="s2">"Solana"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">网络</span><span class="w">
    </span><span class="nl">"general_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="w"> </span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">资产名称</span><span class="w">
    </span><span class="nl">"mx_uid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"de4a8cdc-6be5-3253-9f34-d2c61a89286f"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取充值地址</strong></p>

<ul>
<li>请求方式 POST</li>
<li>请求路径 /v1/depositAddr</li>
<li>权限: View</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>coin_symbol</td>
<td>string</td>
<td>是</td>
<td>可以从/v1/coins 接口获取,具体链的币种名称如USDT,sUSDT,BTC 等</td>
</tr>
</tbody></table>
<h2 id='a471daf080'>提现</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">coin_symbol</span><span class="p">:</span><span class="dl">"</span><span class="s2">BTC</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">amount</span><span class="p">:</span><span class="dl">"</span><span class="s2">0.001</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">addr</span><span class="p">:</span><span class="dl">"</span><span class="s2">bc1qksfjx5ezznnngk6grt04h8lwnta2mxtmjl0etm</span><span class="dl">"</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/withdraw`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span> 
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'coin_symbol'</span><span class="p">:</span><span class="s">'BTC'</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span><span class="s">'0.001'</span><span class="p">,</span>
        <span class="s">'addr'</span><span class="p">:</span><span class="s">'bc1qksfjx5ezznnngk6grt04h8lwnta2mxtmjl0etm'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">body_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/withdraw'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">624</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">提现id</span><span class="w">
    </span><span class="nl">"to_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bc1qksfjx5ezznnngk6grt04h8lwnta2mxtmjl0etm"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">到账地址</span><span class="w">
    </span><span class="nl">"amount_real"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.00000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">到账数量</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.00000000"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">提现数量</span><span class="w">
    </span><span class="nl">"fee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.00000000"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">手续费</span><span class="w">
    </span><span class="nl">"chain_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bitcoin"</span><span class="p">,</span><span class="w"> </span><span class="err">//网络</span><span class="w">
    </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="w"> </span><span class="err">'BTC'</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">币种</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>提现</strong></p>

<ul>
<li>请求方式 POST</li>
<li>请求路径 /v1/withdraw</li>
<li>权限: Withdraw</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>coin_symbol</td>
<td>string</td>
<td>是</td>
<td>可以从/v1/coins 接口获取,具体链的币种名称如USDT,sUSDT,BTC 等</td>
</tr>
<tr>
<td>addr</td>
<td>string</td>
<td>是</td>
<td>到账地址</td>
</tr>
<tr>
<td>amount</td>
<td>number</td>
<td>是</td>
<td>提现数量</td>
</tr>
<tr>
<td>memo</td>
<td>string</td>
<td>否</td>
<td>memo备注</td>
</tr>
<tr>
<td>withdraw_id</td>
<td>string</td>
<td>否</td>
<td>自定义id 最大长度为36 返回值会出现该字段用于幂等处理</td>
</tr>
</tbody></table>
<h2 id='861428a8b4'>获取钱包账户资产</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">asset</span><span class="p">:</span><span class="dl">'</span><span class="s1">USDT</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/main/accounts`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span> 
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'asset'</span><span class="p">:</span> <span class="s">'USDT'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">body_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/main/accounts'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//资产代码</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">总额</span><span class="w">
    </span><span class="nl">"locked"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="err">//</span><span class="w"> </span><span class="err">冻结额</span><span class="w">
    </span><span class="nl">"free"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="err">//</span><span class="w"> </span><span class="err">可用</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取钱包账户资产</strong></p>

<ul>
<li>请求方式 POST</li>
<li>请求路径 /v1/main/accounts</li>
<li>权限: View</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>asset</td>
<td>string</td>
<td>否</td>
<td>资产代码,如 BTC, ETH 等<br/>如果不指定 asset 参数, 则返回全部资产的信息</td>
</tr>
</tbody></table>
<h2 id='0d3c2e7382'>资产划转</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">symbol</span><span class="p">:</span><span class="dl">'</span><span class="s1">USDT</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">amount</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">WALLET_TRADE</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/transfer`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span> 
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'USDT'</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s">'type'</span><span class="p">:</span> <span class="s">'WALLET_TRADE'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">body_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/transfer'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.123"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>资产划转</strong></p>

<ul>
<li>请求方式 POST</li>
<li>请求路径 /v1/transfer</li>
<li>权限: Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>资产代码,如 BTC, ETH 等</td>
</tr>
<tr>
<td>amount</td>
<td>number</td>
<td>是</td>
<td>划转数量</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>WALLET_TRADE 代表则从钱包账户划转到交易账户 TRADE_WALLET代表则从交易账户划转到钱包账户</td>
</tr>
<tr>
<td>transfer_id</td>
<td>string</td>
<td>否</td>
<td>自定义id 最大长度为36 返回值会出现该字段用于幂等处理</td>
</tr>
</tbody></table>
<h2 id='12c1ebfd1f'>子账户资产划转</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">symbol</span><span class="dl">'</span><span class="p">:</span><span class="dl">'</span><span class="s1">BTC</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">amount</span><span class="dl">'</span><span class="p">:</span><span class="dl">'</span><span class="s1">0.001</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">sub_user_id</span><span class="dl">'</span><span class="p">:</span><span class="mi">30000416</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">side</span><span class="dl">'</span><span class="p">:</span><span class="dl">'</span><span class="s1">in</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">transfer_id</span><span class="dl">'</span><span class="p">:</span><span class="dl">'</span><span class="s1">userdefineid001</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/subaccount/transfer`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span> 
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'symbol'</span><span class="p">:</span><span class="s">'BTC'</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span><span class="s">'0.001'</span><span class="p">,</span>
        <span class="s">'sub_user_id'</span><span class="p">:</span><span class="mi">30000416</span><span class="p">,</span>
        <span class="s">'side'</span><span class="p">:</span><span class="s">'in'</span><span class="p">,</span>
        <span class="s">'transfer_id'</span><span class="p">:</span><span class="s">'userdefineid001'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">body_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/subaccount/transfer'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.123"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>子账户资产划转</strong></p>

<ul>
<li>请求方式 POST</li>
<li>请求路径 /v1/subaccount/transfer</li>
<li>权限: Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>资产代码,如 BTC, ETH 等</td>
</tr>
<tr>
<td>amount</td>
<td>number</td>
<td>是</td>
<td>划转数量</td>
</tr>
<tr>
<td>sub_user_id</td>
<td>number</td>
<td>是</td>
<td>子账户id</td>
</tr>
<tr>
<td>side</td>
<td>string</td>
<td>是</td>
<td>in 代表从主账户划入子账户 out 从子账户划出到主账户</td>
</tr>
<tr>
<td>transfer_id</td>
<td>string</td>
<td>否</td>
<td>自定义id 最大长度为36 返回值会出现该字段用于幂等处理</td>
</tr>
</tbody></table>
<h2 id='c3362c0aff'>获取账单</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">asset=BTC&amp;end_time=1651895799668&amp;limit=10</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/ledgers?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span> 
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/ledgers'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'asset=BTC&amp;end_time=1651895799668&amp;limit=10'</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">query_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span> <span class="n">expire_time</span>

    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="s2">"10000"</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">变化数量</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="s2">"10000"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">余额</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1125899906842624029"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"time"</span><span class="p">:</span><span class="s2">"1733468814795"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">时间</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"transfer"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">账单类型</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取 API Key 对应账户的账单,包含一切改变账户余额的记录,如资金划转、交易、手续费收取等</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/ledgers</li>
<li>权限: View</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>asset</td>
<td>string</td>
<td>否</td>
<td>资产代码,如 BTC, ETH 等<br/>可按以下两种形式指定多个资产代码<br/>1. /v1/ledgers?asset=BTC,ETH<br/> 2. /v1/ledgers?asset=BTC&amp;asset=ETH <br/> 如果不指定 asset 参数, 则返回全部资产的账单记录</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回账单记录的最早时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回账单记录的最近时间</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>账单记录id<br/>限定返回账单记录的最大id值</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>账单记录id<br/>限定返回账单记录的最小id值</td>
</tr>
<tr>
<td>limit</td>
<td>int32</td>
<td>否</td>
<td>限定返回账单记录的最大条数<br/>默认值 100</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>否</td>
<td>账单类型 transfer划转,trade交易,fee手续费,rebate系统收取,funding资金费用</td>
</tr>
</tbody></table>

<ul>
<li>Data Source</li>
</ul>

<p>DB</p>
<h2 id='5ac84906d9'>创建订单</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">symbol</span><span class="p">:</span><span class="dl">'</span><span class="s1">BTC_USDT</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">side</span><span class="p">:</span><span class="dl">'</span><span class="s1">buy</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">quantity</span><span class="p">:</span><span class="dl">'</span><span class="s1">0.0001</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">price</span><span class="p">:</span><span class="dl">'</span><span class="s1">90000</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span><span class="dl">'</span><span class="s1">limit</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">market</span><span class="p">:</span><span class="dl">'</span><span class="s1">spot</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>


<span class="cm">/* 
mini合约下单参数 
开多方向
const param = {
  symbol:'BTC_USDT_SWAP',
  side:'buy',
  quantity:'0.0001',
  type:'market',
  market:'lpc',
  mini:true,
  positionMerge:'none',
  marginMethod:'isolate'
}
平多方向
const param = {
  symbol:'BTC_USDT_SWAP',
  side:'sell',
  quantity:'0.0001',
  type:'market',
  market:'lpc',
  mini:true,
  positionMerge:'none',
  marginMethod:'isolate'
  positionId:1125899906842649789
  close:true
}

*/</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/order`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span>  
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'symbol'</span><span class="p">:</span><span class="s">'BTC_USDT'</span><span class="p">,</span>
      <span class="s">'side'</span><span class="p">:</span><span class="s">'buy'</span><span class="p">,</span>
      <span class="s">'quantity'</span><span class="p">:</span><span class="s">'0.0001'</span><span class="p">,</span>
      <span class="s">'price'</span><span class="p">:</span><span class="s">'90000'</span><span class="p">,</span>
      <span class="s">'type'</span><span class="p">:</span><span class="s">'limit'</span><span class="p">,</span>
      <span class="s">'market'</span><span class="p">:</span><span class="s">'spot'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="s">"""
    mini合约下单参数 
    开多方向
    param = {
      'symbol':'BTC_USDT_SWAP',
      'side':'buy',
      'quantity':'0.0001',
      'type':'market',
      'market':'lpc',
      'mini':true
      'positionMerge':'none',
      'marginMethod':'isolate'
    }
    平多方向
    param = {
      'symbol':'BTC_USDT_SWAP',
      'side':'sell',
      'quantity':'0.0001',
      'type':'market',
      'market':'lpc',
      'mini':true
      'positionMerge':'none',
      'marginMethod':'isolate'
      'positionId':1125899906842649789
      'close':true
    }
    """</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">body_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/order'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"orderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4611767382287843330"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单id</span><span class="w">
  </span><span class="nl">"clientOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">自定义id</span><span class="w">
  </span><span class="nl">"createTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390630904"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">创建时间</span><span class="w">
  </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"limit"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单类型</span><span class="w">
  </span><span class="nl">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易方向</span><span class="w">
  </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托数量</span><span class="w">
  </span><span class="nl">"stf"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
  </span><span class="nl">"timeInForce"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gtc"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"mini"</span><span class="p">:</span><span class="s2">"false"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">是不是mini合约</span><span class="w">
  </span><span class="nl">"cancelAfter"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"postOnly"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"positionMerge"</span><span class="p">:</span><span class="w"> </span><span class="s2">"long"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位模式</span><span class="w">  </span><span class="err">long合并多</span><span class="w"> </span><span class="err">short合并空</span><span class="w">
  </span><span class="nl">"positionId"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">提交的仓位id</span><span class="w">
  </span><span class="nl">"marginMethod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cross"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">保证金模式</span><span class="w"> </span><span class="err">全仓</span><span class="w">
  </span><span class="nl">"close"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">是否为可平单</span><span class="w">
  </span><span class="nl">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">杠杠倍数</span><span class="w">
  </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位行为</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"accepted"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单状态</span><span class="w">
  </span><span class="nl">"executedQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交数量</span><span class="w">
  </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">收益</span><span class="w">
  </span><span class="nl">"origin"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">origin</span><span class="w">          
  </span><span class="nl">"brokerId"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">渠道id</span><span class="w">
  </span><span class="nl">"update_id"</span><span class="p">:</span><span class="err">'</span><span class="mi">1125899907137993336</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新id</span><span class="w">
  </span><span class="nl">"executedCost"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交价值</span><span class="w">
  </span><span class="nl">"fillCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
  </span><span class="nl">"fills"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"updateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新时间</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<p><strong>提交委托</strong></p>

<ul>
<li>请求方式 POST</li>
<li>请求路径 /v1/order</li>
<li>权限: Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码,如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等</td>
</tr>
<tr>
<td>side</td>
<td>string</td>
<td>是</td>
<td>交易方向 buy 买,sell 卖</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>委托类型,有效值 limit market</td>
</tr>
<tr>
<td>quantity</td>
<td>decimal</td>
<td>是</td>
<td>委托量</td>
</tr>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>必须 spot 现货,lpc U本位永续</td>
</tr>
<tr>
<td>client_order_id</td>
<td>string</td>
<td>否</td>
<td>委托id,有效值为int64整数的字符串,建议使用提交委托时的Unix时间戳</td>
</tr>
<tr>
<td>price</td>
<td>decimal</td>
<td>否</td>
<td>委托限价</td>
</tr>
<tr>
<td>positionMerge</td>
<td>string</td>
<td>否</td>
<td>持仓方向 合约必须 long合并多 short合并空 none 分仓   如:开多(positionMerge=long,side=buy),平多(positionMerge=long,side=sell),开空(positionMerge=short,side=sell),平空(positionMerge=short,side=buy)</td>
</tr>
<tr>
<td>marginMethod</td>
<td>string</td>
<td>否</td>
<td>合约必须 isolate 逐仓, cross 全仓</td>
</tr>
<tr>
<td>mini</td>
<td>bool</td>
<td>否</td>
<td>是否为mini合约 当为true的时候必须满足 positionMerge=none&amp;&amp;marginMethod=isolate&amp;&amp;type=limit</td>
</tr>
<tr>
<td>leverage</td>
<td>int</td>
<td>否</td>
<td>合约必须 杠杠倍数</td>
</tr>
<tr>
<td>close</td>
<td>bool</td>
<td>否</td>
<td>合约必须 true 平仓单,false 开仓单</td>
</tr>
<tr>
<td>post_only</td>
<td>bool</td>
<td>否</td>
<td>只做maker</td>
</tr>
<tr>
<td>time_in_force</td>
<td>string</td>
<td>否</td>
<td>委托时效性<br/>有效值 gtc, ioc,fok<br/>gtc  表示未完全成交的委托将一直有效, 直到用户撤销该委托<br/>ioc 表示撮合将立即撤销在下单时刻不能完全成交的委托,<br/> 任何成交都将被保留<br/>fok 全部成交否则取消 <br/>默认值 gtc</td>
</tr>
<tr>
<td>positionId</td>
<td>string</td>
<td>否</td>
<td>仓位id</td>
</tr>
</tbody></table>

<blockquote>
<p>委托对象
最多包含该委托的20笔成交
如果委托有多于20笔成交,那么该对象仅包含最后20笔,其他成交请通过 fills 接口获取</p>
</blockquote>
<h2 id='f876a4e1f9'>获取订单详情</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">id=4611772879845982339</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/order?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span>  
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/order'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'id=14118828812271651'</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">query_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"orderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4611767382287843330"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单id</span><span class="w">
  </span><span class="nl">"clientOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">自定义id</span><span class="w">
  </span><span class="nl">"createTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390630904"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">创建时间</span><span class="w">
  </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"limit"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单类型</span><span class="w">
  </span><span class="nl">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易方向</span><span class="w">
  </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托数量</span><span class="w">
  </span><span class="nl">"stf"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
  </span><span class="nl">"timeInForce"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gtc"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"mini"</span><span class="p">:</span><span class="s2">"false"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">是不是mini合约</span><span class="w">
  </span><span class="nl">"cancelAfter"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"postOnly"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"positionMerge"</span><span class="p">:</span><span class="w"> </span><span class="s2">"long"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位模式</span><span class="w">  </span><span class="err">long合并多</span><span class="w"> </span><span class="err">short合并空</span><span class="w">
  </span><span class="nl">"positionId"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">提交的仓位id</span><span class="w">
  </span><span class="nl">"marginMethod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cross"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">保证金模式</span><span class="w"> </span><span class="err">全仓</span><span class="w">
  </span><span class="nl">"close"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">是否为可平单</span><span class="w">
  </span><span class="nl">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">杠杠倍数</span><span class="w">
  </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位行为</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"filled"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单状态</span><span class="w">
  </span><span class="nl">"executedQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交数量</span><span class="w">
  </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">收益</span><span class="w">
  </span><span class="nl">"origin"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">origin</span><span class="w">          
  </span><span class="nl">"brokerId"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">渠道id</span><span class="w">
  </span><span class="nl">"update_id"</span><span class="p">:</span><span class="err">'</span><span class="mi">1125899907137993336</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新id</span><span class="w">
  </span><span class="nl">"executedCost"</span><span class="p">:</span><span class="w"> </span><span class="s2">"103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交价值</span><span class="w">
  </span><span class="nl">"fillCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
  </span><span class="nl">"fills"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">成交详情</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"tradeId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"taker"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产数量</span><span class="w">
          </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">估值</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">手续费</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产数量</span><span class="w">
      </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
      </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">估值</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"updateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新时间</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>获取指定 id 的委托</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/order</li>
<li>权限: View</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>委托id<br/>委托id可以是交易所分配的, <br/>也可以是用户自定义的 (在提交委托时使用client_order_id参数).<br/>当使用自定义id时, 需要在id前添加 “c:” 前缀.<br/>例如: 提交委托时使用了自定义id “123”, 在获取委托时, 需使用 “c:123”.</td>
</tr>
</tbody></table>
<h2 id='e8c2c8c42b'>获取历史订单列表</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">limit=2&amp;market=spot&amp;symbol=BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/history/orders?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span>  
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/history/orders'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'limit=2&amp;market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">query_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"orderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4611767382287843330"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单id</span><span class="w">
    </span><span class="nl">"clientOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">自定义id</span><span class="w">
    </span><span class="nl">"createTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390630904"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">创建时间</span><span class="w">
    </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"limit"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单类型</span><span class="w">
    </span><span class="nl">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易方向</span><span class="w">
    </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托数量</span><span class="w">
    </span><span class="nl">"stf"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
    </span><span class="nl">"timeInForce"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gtc"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"mini"</span><span class="p">:</span><span class="s2">"false"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">是不是mini合约</span><span class="w">
    </span><span class="nl">"cancelAfter"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"postOnly"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"positionMerge"</span><span class="p">:</span><span class="w"> </span><span class="s2">"long"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位模式</span><span class="w">  </span><span class="err">long合并多</span><span class="w"> </span><span class="err">short合并空</span><span class="w">
    </span><span class="nl">"positionId"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">提交的仓位id</span><span class="w">
    </span><span class="nl">"marginMethod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cross"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">保证金模式</span><span class="w"> </span><span class="err">全仓</span><span class="w">
    </span><span class="nl">"close"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">是否为可平单</span><span class="w">
    </span><span class="nl">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">杠杠倍数</span><span class="w">
    </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位行为</span><span class="w">
    </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"filled"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单状态</span><span class="w">
    </span><span class="nl">"executedQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交数量</span><span class="w">
    </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">收益</span><span class="w">
    </span><span class="nl">"origin"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">origin</span><span class="w">          
    </span><span class="nl">"brokerId"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">渠道id</span><span class="w">
    </span><span class="nl">"update_id"</span><span class="p">:</span><span class="err">'</span><span class="mi">1125899907137993336</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新id</span><span class="w">
    </span><span class="nl">"executedCost"</span><span class="p">:</span><span class="w"> </span><span class="s2">"103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交价值</span><span class="w">
    </span><span class="nl">"fillCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
    </span><span class="nl">"fills"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">成交详情</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"tradeId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"taker"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nl">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产数量</span><span class="w">
            </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">估值</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">手续费</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产数量</span><span class="w">
        </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">估值</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"updateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新时间</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取ApiKey对应账户中符合下列条件的委托</strong></p>

<ol>
<li>三个月内的已结算委托, 含已拒绝, 已撤销和已成交委托</li>
<li>全部已成交委托</li>
<li>全部已撤销的部分成交委托</li>
</ol>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/history/orders</li>
<li>权限: View</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场,如 spot, lpc 等,spot为现货,lpc为U本位合约<br/></td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>否</td>
<td>交易对代码,如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等<br/>当 status=unsettled 时, 不指定 symbol 将返回全部交易对的未结算委托<br/>当 status=settled 时, 必须给定 symbol 参数</td>
</tr>
<tr>
<td>start_time</td>
<td>long</td>
<td>否</td>
<td>限定返回委托的最近创建时间</td>
</tr>
<tr>
<td>end_time</td>
<td>long</td>
<td>否</td>
<td>限定返回委托的最近创建时间</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>委托更新 id<br/>限定返回委托的最大更新id</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>委托更新 id<br/>限定返回委托的最小更新id</td>
</tr>
<tr>
<td>limit</td>
<td>long</td>
<td>否</td>
<td>指定最多返回多少个委托</td>
</tr>
</tbody></table>

<ul>
<li><p>该接口支持的参数组合和数据源</p>

<ul>
<li> market + symbol + start_time</li>
<li> market + symbol + start_time + limit</li>
<li> market + symbol + end_time</li>
<li> market + symbol + end_time + limit</li>
<li> market + symbol + start_time + end_time</li>
<li> market + symbol + start_time + end_time + limit</li>
<li> market + symbol + before</li>
<li> market + symbol + before + limit</li>
<li> market + symbol + after</li>
<li> market + symbol + after + limit</li>
</ul></li>
</ul>

<blockquote>
<p>订单委托按结算时间由早及近排序</p>
</blockquote>
<h2 id='ef41056898'>获取未成交订单列表</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">market=spot&amp;symbol=BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/pending/orders?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span>  
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/pending/orders'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">query_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"orderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4611767382287843330"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单id</span><span class="w">
    </span><span class="nl">"clientOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">自定义id</span><span class="w">
    </span><span class="nl">"createTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390630904"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">创建时间</span><span class="w">
    </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"limit"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单类型</span><span class="w">
    </span><span class="nl">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易方向</span><span class="w">
    </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托数量</span><span class="w">
    </span><span class="nl">"stf"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
    </span><span class="nl">"timeInForce"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gtc"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"mini"</span><span class="p">:</span><span class="s2">"false"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">是不是mini合约</span><span class="w">
    </span><span class="nl">"cancelAfter"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"postOnly"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"positionMerge"</span><span class="p">:</span><span class="w"> </span><span class="s2">"long"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位模式</span><span class="w">  </span><span class="err">long合并多</span><span class="w"> </span><span class="err">short合并空</span><span class="w">
    </span><span class="nl">"positionId"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">提交的仓位id</span><span class="w">
    </span><span class="nl">"marginMethod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cross"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">保证金模式</span><span class="w"> </span><span class="err">全仓</span><span class="w">
    </span><span class="nl">"close"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">是否为可平单</span><span class="w">
    </span><span class="nl">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">杠杠倍数</span><span class="w">
    </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位行为</span><span class="w">
    </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"accepted"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单状态</span><span class="w">
    </span><span class="nl">"executedQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交数量</span><span class="w">
    </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">收益</span><span class="w">
    </span><span class="nl">"origin"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">origin</span><span class="w">          
    </span><span class="nl">"brokerId"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">渠道id</span><span class="w">
    </span><span class="nl">"update_id"</span><span class="p">:</span><span class="err">'</span><span class="mi">1125899907137993336</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新id</span><span class="w">
    </span><span class="nl">"executedCost"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交价值</span><span class="w">
    </span><span class="nl">"fillCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
    </span><span class="nl">"fills"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nl">"updateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新时间</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取未成交的委托</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/pending/orders</li>
<li>权限: View</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场,如 spot, lpc 等,spot为现货,lpc为U本位合约<br/></td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>否</td>
<td>交易对代码,如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等<br/>当 status=unsettled 时, 不指定 symbol 将返回全部交易对的未结算委托<br/>当 status=settled 时, 必须给定 symbol 参数</td>
</tr>
</tbody></table>

<blockquote>
<p>返回的订单委托按创建时间由早及近排序</p>
</blockquote>
<h2 id='3eedd32d80'>取消订单</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span><span class="dl">'</span><span class="s1">14244173146202090</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/order/delete`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'id'</span><span class="p">:</span> <span class="s">'14245272657638034'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">body_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/order/delete'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="err">n</span><span class="p">]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">取消数量</span><span class="w">
</span></code></pre></div>
<p><strong>撤销指定 id 的委托</strong></p>

<ul>
<li>请求方式 POST</li>
<li>请求路径 /v1/order/delete</li>
<li>权限: Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>委托id<br>委托id可以是交易所分配的,<br/>也可以是用户自定义的（在提交委托时使用client_order_id参数）。<br>当使用自定义id时,需要在id前添加 “c:” 前缀。<br/>例如：提交委托时使用了自定义id “123”, 在撤销委托时,需使用 “c:123”。</td>
</tr>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场,如 spot, lpc 等,spot为现货,lpc为U本位合约</td>
</tr>
</tbody></table>

<blockquote>
<p>如果指定id的委托已结算,或者不存在指定id的委托,会收到-30001错误。</p>
</blockquote>
<h2 id='eaa1a6d463'>取消批量订单</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">symbol</span><span class="p">:</span><span class="dl">'</span><span class="s1">BTC_USDT</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/orders/delete`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span> 
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'BTC_USDT'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">body_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/orders/delete'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 

    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="err">n</span><span class="p">]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">取消数量</span><span class="w">
</span></code></pre></div>
<p><strong>撤销全部委托</strong></p>

<ul>
<li>请求方式 POST</li>
<li>请求路径 /v1/orders/delete</li>
<li>权限: Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场,如 spot, lpc 等,spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码<br/>如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等</td>
</tr>
<tr>
<td>side</td>
<td>string</td>
<td>否</td>
<td>buy 或者 sell</td>
</tr>
</tbody></table>

<blockquote>
<p>如果请求被正确执行,返回空数组,否则返回错误信息</p>
</blockquote>
<h2 id='430d71f05a'>获取仓位</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">market=lpc&amp;symbol=BTC_USDT_SWAP</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/positions?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span> 

        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/positions'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'market=lpc&amp;symbol=BTC_USDT_SWAP'</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="c1"># POST or DELETE replace query_str with body_str
</span>    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">query_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"entryPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"109398.9"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开仓价格</span><span class="w">
    </span><span class="nl">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易代码</span><span class="w">
    </span><span class="nl">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">杠杆倍数</span><span class="w">
    </span><span class="nl">"maintMargin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0050000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">维持保证金率</span><span class="w">
    </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位数量</span><span class="w"> </span><span class="err">空仓</span><span class="mf">0.1</span><span class="w">
    </span><span class="nl">"posMargin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1093.989"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">保证金</span><span class="w">
    </span><span class="nl">"marginMethod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cross"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">保证金模式</span><span class="w"> </span><span class="err">全仓</span><span class="w">
    </span><span class="nl">"closableQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">可平仓位数量</span><span class="w">
    </span><span class="nl">"initMargin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.1000000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">初始保证金率</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1125899906842624158"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"orderMargin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">委托保证金</span><span class="w">
    </span><span class="nl">"mergeMode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"short"</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">仓位模式</span><span class="w"> </span><span class="err">short</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取仓位</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/positions</li>
<li>权限: View</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>position_id</td>
<td>string</td>
<td>否</td>
<td>仓位id 如存在这个参数,优先级最高</td>
</tr>
<tr>
<td>market</td>
<td>string</td>
<td>否</td>
<td>交易对市场，如 lpc 等，lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>否</td>
<td>配合market使用,交易对代码<br/>如 BTC_USDT_SWAP, ETH_USDT_SWAP 等</td>
</tr>
</tbody></table>
<h2 id='106a02279b'>获取成交明细</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.ktx.com/papi</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">limit=2&amp;market=spot&amp;symbol=BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">exprieTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">''</span><span class="o">+</span> <span class="nx">exprieTime</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/fills?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nx">exprieTime</span> 

        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.ktx.com/papi'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/fills'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'limit=2&amp;market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">expire_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="c1"># POST or DELETE replace query_str with body_str
</span>    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="p">(</span><span class="s">''</span> <span class="o">+</span> <span class="n">expire_time</span> <span class="o">+</span> <span class="n">query_str</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="n">expire_time</span> 
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"product"</span><span class="p">:</span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
    </span><span class="nl">"fees"</span><span class="p">:[{</span><span class="nl">"amount"</span><span class="p">:</span><span class="s2">"10"</span><span class="p">,</span><span class="nl">"asset"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="nl">"value"</span><span class="p">:</span><span class="s2">"10"</span><span class="p">}],</span><span class="err">//</span><span class="w"> </span><span class="err">手续费</span><span class="w">
    </span><span class="nl">"quantity"</span><span class="p">:</span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交数量</span><span class="w">
    </span><span class="nl">"orderId"</span><span class="p">:</span><span class="s2">"4611772879845982371"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单id</span><span class="w">
    </span><span class="nl">"fillId"</span><span class="p">:</span><span class="s2">"1125899906842624338"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交记录id</span><span class="w">
    </span><span class="nl">"price"</span><span class="p">:</span><span class="s2">"1000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
    </span><span class="nl">"time"</span><span class="p">:</span><span class="s2">"1733541360859"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
    </span><span class="nl">"taker"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">是否为吃单</span><span class="w">
    </span><span class="nl">"profit"</span><span class="p">:</span><span class="s2">"-9060"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">收益</span><span class="w">
    </span><span class="nl">"tradeId"</span><span class="p">:</span><span class="mi">26</span><span class="w"> 
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取成交记录</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/fills</li>
<li>权限: View</li>
<li>请求参数(需要排序)</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场,如 spot, lpc 等,spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>order_id</td>
<td>string</td>
<td>否</td>
<td>交易所分配的委托id<br/>限定仅返回指定委托的成交记录<br/>如果不指定该参数,请指定 symbol</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>否</td>
<td>交易对代码<br/>如 BTC_USDT, ETH_USDT, BTC_USDT_SWAP 等<br/>限定仅返回指定交易对的成交记录<br/>如果不指定该参数,请指定 order_id</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回成交记录的最早时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回成交记录的最近时间</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>成交记录 fillId<br/>限定返回成交记录的最大id</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>成交记录 fillId<br/>限定返回成交记录的最小id</td>
</tr>
<tr>
<td>limit</td>
<td>int32</td>
<td>否</td>
<td>限定返回结果的最大条数<br/>默认值 100</td>
</tr>
</tbody></table>

<ul>
<li><p>该接口支持的参数组合和数据源</p>

<ul>
<li>symbol  --&gt; database</li>
<li>symbol + limit  --&gt; database</li>
<li>symbol + start_time  --&gt; database</li>
<li>symbol + start_time + limit  --&gt; database</li>
<li>symbol + end_time  --&gt; database</li>
<li>symbol + end_time + limit  --&gt; database</li>
<li>symbol + start_time + end_time  --&gt; database</li>
<li>symbol + start_time + end_time + limit  --&gt; database</li>
<li>symbol + before  --&gt; database</li>
<li>symbol + before + limit  --&gt; database</li>
<li>symbol + after  --&gt; database</li>
<li>symbol + after + limit  --&gt; database</li>
<li>order_id  --&gt; database</li>
<li>order_id + limit  --&gt; database</li>
<li>order_id + before  --&gt; database</li>
<li>order_id + before + limit  --&gt; database</li>
</ul></li>
</ul>

<blockquote>
<p>返回结果按成交记录id由小到大排序</p>
</blockquote>
<h1 id='user-data'>User Data 推送</h1><h2 id='overview-2'>Overview</h2>
<blockquote>
<p>例子</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">ktxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://u-stream.ktx.com</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e2bd17ff73e8531c0f3c26f93e48bfa402a3b13</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">ca55beb9e45d4f30b3959b464402319b9e12bac7</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">"</span><span class="s2">/user/verify</span><span class="dl">"</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="p">};</span>


<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ktxws</span><span class="p">);</span>

  <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">ktxws</span><span class="p">);</span>
  <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
      <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">LOGIN</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">auth</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span> <span class="dl">"</span><span class="s2">api-sign</span><span class="dl">"</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}));</span>
    <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">ws</span><span class="p">.</span><span class="nx">ping</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
    <span class="p">},</span><span class="mi">30000</span><span class="p">)</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span>  <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error </span><span class="dl">'</span><span class="p">,</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span> <span class="c1">// the data may be is error message,check the data's stream is order or account</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">websocket</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://u-stream.ktx.com'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e2bd17ff73e8531c0f3c26f93e48bfa402a3b13'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'ca55beb9e45d4f30b3959b464402319b9e12bac7'</span>
<span class="n">SIGN</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="s">"/user/verify"</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">close_status_code</span><span class="p">,</span> <span class="n">close_msg</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Status Code:"</span><span class="p">,</span> <span class="n">close_status_code</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Message:"</span><span class="p">,</span> <span class="n">close_msg</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ping_loop</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
  <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">"ping"</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="p">}</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">({</span>
        <span class="s">"method"</span><span class="p">:</span> <span class="s">"LOGIN"</span><span class="p">,</span>
        <span class="s">"auth"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"api-key"</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
            <span class="s">"api-sign"</span><span class="p">:</span> <span class="n">SIGN</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### opened ###"</span><span class="p">)</span>
    <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">ping_loop</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">ws</span><span class="p">,),</span> <span class="n">daemon</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">start</span><span class="p">()</span>



<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="c1"># websocket.enableTrace(True)
</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div>
<p>使用 Websocket 推送服务可以及时获取账户的余额及委托变动信息。</p>

<p><strong>连接 Websocket 服务器</strong></p>

<p>请使用以下 URL 连接 Websocket 服务器：</p>

<p>wss://u-stream.ktx.com</p>

<p><strong>在连接时,请附加以下HTTP请求头</strong></p>

<ul>
<li>api-key</li>
<li>api-sign</li>
<li>api-expire-time</li>
</ul>

<p><em>具体方法请参考<a href="#authentication">Authentication</a>章节</em></p>

<blockquote>
<p>数据流
在成功建立连接后,客户端将收到ApiKey对应账户的余额变动信息及委托变动信息。格式如下:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"account"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">Account</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"order"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"order"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='account'>Account</h2>
<p><strong>当账户余额发生变更时,会收到account事件</strong></p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"account"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">总额</span><span class="w">
    </span><span class="nl">"locked"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">冻结额</span><span class="w">
    </span><span class="nl">"free"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">可用</span><span class="w">
    </span><span class="nl">"withdrawable"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">可转出额</span><span class="w">
    </span><span class="nl">"collateral"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">是否抵扣</span><span class="w">
    </span><span class="nl">"discountForMargin"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">可选字段</span><span class="w"> </span><span class="err">保证金抵扣率</span><span class="w">
    </span><span class="nl">"discountForFee"</span><span class="p">:</span><span class="s2">"1"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">可选字段</span><span class="w"> </span><span class="err">手续费抵扣率</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='position'>Position</h2>
<p><strong>当仓位信息发送变更时,会收到position事件</strong></p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"position"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1125899906842624003"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位id</span><span class="w">
      </span><span class="nl">"symbol"</span><span class="p">:</span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
      </span><span class="nl">"quantity"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">数量</span><span class="w">
      </span><span class="nl">"entryPrice"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开仓均价</span><span class="w">
      </span><span class="nl">"mergeMode"</span><span class="p">:</span><span class="s2">"long"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位模式</span><span class="w">
      </span><span class="nl">"marginMethod"</span><span class="p">:</span><span class="s2">"isolate"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">保证金模式</span><span class="w">
      </span><span class="nl">"leverage"</span><span class="p">:</span><span class="s2">"10.0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">杠杠</span><span class="w">
      </span><span class="nl">"initMargin"</span><span class="p">:</span><span class="s2">"0.1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">起始保证金率</span><span class="w">
      </span><span class="nl">"maintMargin"</span><span class="p">:</span><span class="s2">"0.005"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">维持保证金率</span><span class="w">
      </span><span class="nl">"posMargin"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">持仓保证金</span><span class="w">
      </span><span class="nl">"orderMargin"</span><span class="p">:</span><span class="s2">"1009.8990000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托保证金</span><span class="w">
      </span><span class="nl">"closableQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">可平仓位数量</span><span class="w">

  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='order'>Order</h2>
<p><strong>当委托发生变更时,会收到order事件</strong></p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"order"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
    </span><span class="nl">"orderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4611767382287843330"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单id</span><span class="w">
      </span><span class="nl">"clientOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">自定义id</span><span class="w">
      </span><span class="nl">"createTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390630904"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">创建时间</span><span class="w">
      </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"limit"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单类型</span><span class="w">
      </span><span class="nl">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易方向</span><span class="w">
      </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托数量</span><span class="w">
      </span><span class="nl">"stf"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="nl">"timeInForce"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gtc"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"mini"</span><span class="p">:</span><span class="s2">"false"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">是不是mini合约</span><span class="w">
      </span><span class="nl">"cancelAfter"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"postOnly"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"positionMerge"</span><span class="p">:</span><span class="w"> </span><span class="s2">"long"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位模式</span><span class="w"> </span><span class="err">long合并多</span><span class="w"> </span><span class="err">short合并空</span><span class="w">
      </span><span class="nl">"positionId"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">提交的仓位id</span><span class="w">
      </span><span class="nl">"marginMethod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cross"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">保证金模式</span><span class="w"> </span><span class="err">全仓</span><span class="w">
      </span><span class="nl">"close"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">是否为可平单</span><span class="w">
      </span><span class="nl">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">杠杠倍数</span><span class="w">
      </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位行为</span><span class="w">
      </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"filled"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单状态</span><span class="w">
      </span><span class="nl">"executedQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交数量</span><span class="w">
      </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">收益</span><span class="w">
      </span><span class="nl">"origin"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">origin</span><span class="w">          
      </span><span class="nl">"brokerId"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">渠道id</span><span class="w">
      </span><span class="nl">"update_id"</span><span class="p">:</span><span class="err">'</span><span class="mi">1125899907137993336</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新id</span><span class="w">
      </span><span class="nl">"executedCost"</span><span class="p">:</span><span class="w"> </span><span class="s2">"103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交价值</span><span class="w">
      </span><span class="nl">"fillCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
      </span><span class="nl">"fills"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">成交详情</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"tradeId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"taker"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产数量</span><span class="w">
            </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">估值</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
      </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">手续费</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产数量</span><span class="w">
        </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">估值</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
      </span><span class="nl">"updateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新时间</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h1 id='errors'>Errors</h1><h2 id='e08c1d4f9a'>错误码</h2>
<table><thead>
<tr>
<th style="text-align: center">Code</th>
<th style="text-align: center">描述</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center">-10000</td>
<td style="text-align: center">网络或服务故障</td>
</tr>
<tr>
<td style="text-align: center">-10001</td>
<td style="text-align: center">非法状态</td>
</tr>
<tr>
<td style="text-align: center">-10002</td>
<td style="text-align: center">未实现</td>
</tr>
<tr>
<td style="text-align: center">-11001</td>
<td style="text-align: center">请求超时</td>
</tr>
<tr>
<td style="text-align: center">-11002</td>
<td style="text-align: center">无权限</td>
</tr>
<tr>
<td style="text-align: center">-11003</td>
<td style="text-align: center">访问次数超限</td>
</tr>
<tr>
<td style="text-align: center">-11004</td>
<td style="text-align: center">用量超限</td>
</tr>
<tr>
<td style="text-align: center">-12001</td>
<td style="text-align: center">不可识别的事件</td>
</tr>
<tr>
<td style="text-align: center">-12002</td>
<td style="text-align: center">可识别但不支持的事件</td>
</tr>
<tr>
<td style="text-align: center">-12003</td>
<td style="text-align: center">不可识别的请求</td>
</tr>
<tr>
<td style="text-align: center">-12004</td>
<td style="text-align: center">可识别但不支持的请求</td>
</tr>
<tr>
<td style="text-align: center">-12011</td>
<td style="text-align: center">不可识别的参数</td>
</tr>
<tr>
<td style="text-align: center">-12012</td>
<td style="text-align: center">可识别但不支持的参数</td>
</tr>
<tr>
<td style="text-align: center">-12013</td>
<td style="text-align: center">缺少必要的参数</td>
</tr>
<tr>
<td style="text-align: center">-12014</td>
<td style="text-align: center">参数值为空</td>
</tr>
<tr>
<td style="text-align: center">-12015</td>
<td style="text-align: center">参数值无效</td>
</tr>
<tr>
<td style="text-align: center">-12101</td>
<td style="text-align: center">无效的签名</td>
</tr>
<tr>
<td style="text-align: center">-12102</td>
<td style="text-align: center">无效的JSON</td>
</tr>
<tr>
<td style="text-align: center">-12103</td>
<td style="text-align: center">apikey ip受限制</td>
</tr>
<tr>
<td style="text-align: center">-20001</td>
<td style="text-align: center">实例不存在</td>
</tr>
<tr>
<td style="text-align: center">-20002</td>
<td style="text-align: center">实例重复</td>
</tr>
<tr>
<td style="text-align: center">-20003</td>
<td style="text-align: center">实例在使用，不能移除</td>
</tr>
<tr>
<td style="text-align: center">-20004</td>
<td style="text-align: center">超限</td>
</tr>
<tr>
<td style="text-align: center">-20005</td>
<td style="text-align: center">余额不足</td>
</tr>
<tr>
<td style="text-align: center">-21000</td>
<td style="text-align: center">未知错误</td>
</tr>
<tr>
<td style="text-align: center">-21001</td>
<td style="text-align: center">FOK失败</td>
</tr>
<tr>
<td style="text-align: center">-21002</td>
<td style="text-align: center">Post Only订单被拒绝</td>
</tr>
<tr>
<td style="text-align: center">-21003</td>
<td style="text-align: center">参数值无效</td>
</tr>
<tr>
<td style="text-align: center">-21004</td>
<td style="text-align: center">缺少header</td>
</tr>
<tr>
<td style="text-align: center">-21005</td>
<td style="text-align: center">header为空</td>
</tr>
<tr>
<td style="text-align: center">-21006</td>
<td style="text-align: center">header值无效</td>
</tr>
<tr>
<td style="text-align: center">-21007</td>
<td style="text-align: center">json格式不对</td>
</tr>
<tr>
<td style="text-align: center">-21008</td>
<td style="text-align: center">签名无效</td>
</tr>
<tr>
<td style="text-align: center">-21084</td>
<td style="text-align: center">非法杠杆倍数</td>
</tr>
<tr>
<td style="text-align: center">-21100</td>
<td style="text-align: center">参数格式非法</td>
</tr>
<tr>
<td style="text-align: center">-21101</td>
<td style="text-align: center">非法订单ID</td>
</tr>
<tr>
<td style="text-align: center">-21102</td>
<td style="text-align: center">非法客户端订单ID</td>
</tr>
<tr>
<td style="text-align: center">-21103</td>
<td style="text-align: center">非法来源</td>
</tr>
<tr>
<td style="text-align: center">-21104</td>
<td style="text-align: center">非法代理ID</td>
</tr>
<tr>
<td style="text-align: center">-21105</td>
<td style="text-align: center">非法产品ID</td>
</tr>
<tr>
<td style="text-align: center">-21106</td>
<td style="text-align: center">非法订单类型</td>
</tr>
<tr>
<td style="text-align: center">-21107</td>
<td style="text-align: center">非法价格</td>
</tr>
<tr>
<td style="text-align: center">-21108</td>
<td style="text-align: center">非法下单数量</td>
</tr>
<tr>
<td style="text-align: center">-21109</td>
<td style="text-align: center">非法可见数量</td>
</tr>
<tr>
<td style="text-align: center">-21110</td>
<td style="text-align: center">禁止自成交</td>
</tr>
<tr>
<td style="text-align: center">-21111</td>
<td style="text-align: center">无效time in force</td>
</tr>
<tr>
<td style="text-align: center">-21112</td>
<td style="text-align: center">无效cancel after</td>
</tr>
<tr>
<td style="text-align: center">-21113</td>
<td style="text-align: center">非法触发条件</td>
</tr>
<tr>
<td style="text-align: center">-21114</td>
<td style="text-align: center">非法触发价格</td>
</tr>
<tr>
<td style="text-align: center">-21115</td>
<td style="text-align: center">非法仓位ID</td>
</tr>
<tr>
<td style="text-align: center">-21116</td>
<td style="text-align: center">仓位模式参数非法</td>
</tr>
<tr>
<td style="text-align: center">-21118</td>
<td style="text-align: center">非法保证金模式</td>
</tr>
<tr>
<td style="text-align: center">-21201</td>
<td style="text-align: center">权限不足</td>
</tr>
<tr>
<td style="text-align: center">-21211</td>
<td style="text-align: center">订单ID重复</td>
</tr>
<tr>
<td style="text-align: center">-21212</td>
<td style="text-align: center">用户端订单ID重复</td>
</tr>
<tr>
<td style="text-align: center">-21213</td>
<td style="text-align: center">成交过多</td>
</tr>
<tr>
<td style="text-align: center">-21214</td>
<td style="text-align: center">未成交订单超限</td>
</tr>
<tr>
<td style="text-align: center">-21215</td>
<td style="text-align: center">未触发订单超限</td>
</tr>
<tr>
<td style="text-align: center">-21301</td>
<td style="text-align: center">余额不足</td>
</tr>
<tr>
<td style="text-align: center">-21401</td>
<td style="text-align: center">非法买卖方向</td>
</tr>
<tr>
<td style="text-align: center">-21402</td>
<td style="text-align: center">平仓方向错误</td>
</tr>
<tr>
<td style="text-align: center">-21403</td>
<td style="text-align: center">禁止开新仓</td>
</tr>
<tr>
<td style="text-align: center">-21411</td>
<td style="text-align: center">达到风险限额</td>
</tr>
<tr>
<td style="text-align: center">-22001</td>
<td style="text-align: center">无效的转账</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>
  </body>
      <script>
        const lang_btn = document.getElementById('lang_box');

        const btnSpotSelect = document.getElementById('btn_spot-select')
        const spot_select = document.getElementById('spot_select')

        const exLogo = document.getElementById('ex-logo')

        const url = GetUrlRelativePath();

        if(url.indexOf('en') != -1){
          //英文
          btnSpotSelect.innerHTML = 'Spot'
          lang_btn.innerHTML = '中文';


          lang_btn.href = url.replace('en/', 'zh/');


          exLogo.onclick = function () {
            window.location.href = 'https://www.ktx.com/en'
          }
        }else{
          //中文
          lang_btn.innerHTML = 'English';


          lang_btn.href = url.replace('zh/', 'en/');

          exLogo.onclick = function () {
            window.location.href = 'https://www.ktx.com/zh'
          }
        }

        if(location.href.indexOf('/spot/v4/') > 0){
          btn_spot_v4.className = 'current';
          btn_contract_coin.className = '';
          btn_contract.className = '';
          btn_spot.className = '';
          spot_select.className = spot_select.className + ' current';
          btnSpotSelect.innerHTML = btnSpotSelect.innerHTML + ' v4'
        } else if(location.href.indexOf('/spot/v3/') > 0){
          btn_spot.className = 'current';
          btn_contract_coin.className = '';
          btn_contract.className = '';
          btn_spot_v4.className = '';
          spot_select.className = spot_select.className + ' current';
          btnSpotSelect.innerHTML = btnSpotSelect.innerHTML + ' v3'
        }
        else if(location.href.indexOf('/futures-coin/') > 0){
          btn_spot.className = '';
          btn_contract_coin.className = 'current';
          btn_contract.className = '';
          btn_spot_v4.className = '';
        }
        else if(location.href.indexOf('/futures/v4') > 0){
          btn_spot.className = '';
          btn_contract_coin.className = '';
          btn_contract.className = '';
          btn_contract.innerHTML = btn_contract.innerHTML + ' v4';
          btn_contract_v3.className = '';
          btn_contract_v4.className = 'current';
          btn_spot_v4.className = '';
          console.log('futures-v4', btn_contract)
        }
        else if(location.href.indexOf('/futures/') > 0){
          btn_spot.className = '';
          btn_contract_coin.className = '';
          btn_contract.innerHTML = btn_contract.innerHTML + ' v3';
          btn_contract.className = '';
          btn_contract_v4.className = '';
          btn_contract_v3.className = 'current';
          btn_spot_v4.className = '';
          console.log('futures-v3', btn_contract)
        }

        lang_btn.style.display = 'block';
        function GetUrlRelativePath(){
          let url = document.location.toString();
          let arrUrl = url.split("//");
          let start = arrUrl[1].indexOf("/");
          let relUrl = arrUrl[1].substring(start);
          if(relUrl.indexOf("?") != -1){
            relUrl = relUrl.split("?")[0];
          }
          if(relUrl.indexOf("#") != -1){
            relUrl = relUrl.split("#")[0];
          }
          return relUrl;
    　　}
      </script>
</html>


